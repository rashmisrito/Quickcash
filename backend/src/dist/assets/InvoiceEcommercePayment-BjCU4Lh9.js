import{c as X,u as Z,R as o,r as ee,j as t,L as te}from"./index-D-Z3PEJc.js";import{a as b,g as ae,B as P}from"./App-C5vhFMem.js";import{C as $}from"./index-DNjE5cWk.js";import{O as se}from"./index-BzwH-YQC.js";/* empty css                        */import{C as ne}from"./ColorButton-NPYyAwOA.js";import{B as oe}from"./Backdrop-r2QkIdSB.js";import{C as re}from"./CircularProgress-CnuOw79S.js";import{G as r}from"./Grid-Bu6buGuE.js";import{C as z}from"./CardContent-27q7DT88.js";import{T as f}from"./Typography-XE6xpzxH.js";import{S as ie}from"./Stack-COLoxqbZ.js";import{T as m}from"./TextField-RtVheVmu.js";import{B as ce}from"./Box-DCyzdUAE.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./styled-ibrWRFOc.js";import"./Button-paA1xTrW.js";import"./ButtonBase-DppN0Hkz.js";import"./TransitionGroupContext-PLEewXdM.js";import"./utils-CzilLcR2.js";import"./styled-D1orPW_A.js";import"./createStyled-BOVCN3aQ.js";import"./FormControl-Bhzdesby.js";import"./Select-EloRlcax.js";import"./Menu-BTdQhGPK.js";import"./createSvgIcon-CLxdQzf4.js";import"./isMuiElement-CB7WGySX.js";function le(d){return t.jsxs(f,{variant:"body2",color:"text.secondary",align:"center",...d,children:["Copyright Â© ",t.jsx(te,{color:"inherit",to:"/",style:{textDecoration:"none"},children:"Quick Cash"})," ",new Date().getFullYear(),"."]})}function Oe(){var N;const d=X();var w=(N=d==null?void 0:d.search)==null?void 0:N.replace("?code=","");const y="api";var F=$.AES.decrypt(w,"ganesh"),g=F.toString($.enc.Utf8);const i=Z(),[c,L]=o.useState(""),[C,T]=o.useState(0),[S,B]=o.useState(""),[E,O]=o.useState(""),[R,A]=o.useState(""),[W,H]=o.useState(""),[V,_]=o.useState(""),[u,G]=o.useState("");ee.useEffect(()=>{M()},[g]);const[s,j]=o.useState({number:"",expiry:"",cvc:"",name:"",focus:"",zipcode:""}),M=async()=>{await b.get(`/${y}/v1/ecommerce/invoice-frontend/${g}`).then(e=>{var a,n,l,h,D,I;e.data.status=="201"&&(H((n=(a=e==null?void 0:e.data)==null?void 0:a.data)==null?void 0:n.othersInfo),A((h=(l=e==null?void 0:e.data)==null?void 0:l.data)==null?void 0:h.userid),T(parseFloat((I=(D=e==null?void 0:e.data)==null?void 0:D.data)==null?void 0:I.dueAmount)),O(e.data.data.due_date),B(e.data.data.currency),L(e.data.data.status))}).catch(e=>{var a,n;_(e.response.data.message),G((n=(a=e==null?void 0:e.response)==null?void 0:a.data)==null?void 0:n.data)})},[J,v]=o.useState(!1),Q=()=>{v(!1)},U=async e=>{v(!0),await b.get(`/${y}/v1/itiopay/inv/status/${e}`).then(a=>{a.data.status==201&&(a.data.data==0||(a.data.data==1?i(`/inv-response/${e}`):a.data.data==2?i(`/inv-response/${e}`):a.data.data==9?i(`/inv-response/${e}`):a.data.data==22?i(`/inv-response/${e}`):a.data.data==23?i(`/inv-response/${e}`):a.data.data==24&&i(`/inv-response/${e}`)))}).catch(a=>{k(a.response.data.data,"error"),console.log(a)})},Y=async()=>{s.name==""||s.number==""||s.expiry==""||s.cvc==""||s.zipcode==""?alert("Please fill all of the fields"):(v(!0),await b.post(`/${y}/v1/itiopay/inv/pay`,{userid:R,othersInfo:W,reference:g,amount:C,currency:S,cardsDetails:s}).then(e=>{if(e.data.status==201){localStorage.setItem("transID",e.data.transID),window.open(`${e.data.data}`,"_blank");var a=0,n=setInterval(function(){a+=1,a===20&&clearInterval(n),U(e.data.transID)},2e3)}}).catch(e=>{k(e.response.data.data,"error"),console.log(e)}))},k=(e,a)=>{a=="error"?P.error(e,{position:"top-center",autoClose:6e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}):P.success(e,{position:"top-center",autoClose:6e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})},p=e=>{const{name:a,value:n}=e.target;if(a=="expiry"){const l=K(n);j(h=>({...h,[a]:l}))}else j(l=>({...l,[a]:n}))};function q(e=""){return e.replace(/\D+/g,"")}function K(e){const a=q(e);return a.length>=3?`${a.slice(0,2)}/${a.slice(2,4)}`:a}const x=e=>{j(a=>({...a,focus:e.target.name}))};return t.jsxs("div",{style:{marginTop:"79px"},children:[t.jsxs(oe,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:J,onClick:Q,children:[t.jsx(re,{color:"inherit"})," Processing..."]}),(c=="unpaid"||c=="partial")&&t.jsxs(r,{container:!0,spacing:2,children:[t.jsx(r,{item:!0,xs:1}),t.jsx(r,{item:!0,xs:12,sm:5,children:t.jsx(r,{sx:{borderRadius:"12px",height:"100%"},children:t.jsxs(z,{children:[t.jsx(f,{variant:"h3",color:"text.secondary",sx:{fontFamily:"mono"},gutterBottom:!0,children:"Payment Summary"}),t.jsx(r,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:t.jsxs(r,{sx:{marginTop:"12px"},children:[t.jsxs(f,{variant:"h5",sx:{fontFamily:"mono"},children:["Amount: ",ae(S),C]}),t.jsxs(f,{variant:"h5",sx:{fontFamily:"mono"},children:["Due Date: ",E]})]})})]})})}),t.jsx(r,{item:!0,xs:12,sm:5,children:t.jsxs(z,{component:ie,spacing:3,sx:{height:"auto",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.3)",justifyContent:"center",padding:"29px",borderRadius:"12px"},children:[t.jsx(se,{number:s.number,expiry:s.expiry,cvc:s.cvc,name:s.name}),t.jsx(m,{label:"Name",name:"name",type:"text",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.name,onChange:p,onFocus:x,placeholder:"Name"}),t.jsx(m,{label:"Card Number",name:"number",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},inputProps:{maxLength:16},value:s.number,onChange:p,onFocus:x}),t.jsxs(ce,{sx:{display:"flex",gap:3},children:[t.jsx(m,{fullWidth:!0,label:"CVV",name:"cvc",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.cvc,onChange:p,onFocus:x,inputProps:{maxLength:3}}),t.jsx(m,{fullWidth:!0,label:"Expiry Date",name:"expiry",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.expiry,onChange:p,onFocus:x,inputProps:{maxLength:5,min:`${new Date().toISOString().split("T")[0]}`}}),t.jsx(m,{fullWidth:!0,label:"Postal Code",name:"zipcode",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.zipcode,onChange:p,inputProps:{maxLength:6}})]}),t.jsx(ne,{size:"large",sx:{fontWeight:"bold"},onClick:()=>Y(),children:"Proceed to pay"})]})})]}),c=="pending"||c=="Test"||c=="approved"||c=="paid"?t.jsx(r,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",padding:"16px",fontSize:"30px"},children:t.jsx("div",{className:"card",children:t.jsxs("div",{className:"header",children:[t.jsxs("div",{className:"content",children:[t.jsx("span",{className:"title",children:"Payment Already done"}),t.jsx("p",{className:"message",children:"Thank you for payment."})]}),t.jsx("div",{className:"actions",children:t.jsx("button",{type:"button",className:"history",children:"Neo Connect"})})]})})}):null,V?t.jsx(t.Fragment,{children:t.jsx(r,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",padding:"16px",fontSize:"30px"},children:t.jsx("div",{className:"card",children:t.jsxs("div",{className:"header",children:[t.jsxs("div",{className:"content",children:[t.jsx("span",{className:"title",children:"Link has been expired"}),t.jsx("p",{className:"message",children:u?`Due date was on ${u==null?void 0:u.due_date}`:null})]}),t.jsx("div",{className:"actions",children:t.jsx("button",{type:"button",className:"history",children:"Neo Connect"})})]})})})}):null,t.jsx(le,{sx:{mt:8,mb:4}})]})}export{Oe as default};

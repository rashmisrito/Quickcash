import{R as n,f as Oe,r as _e,j as e}from"./index-CGCJRBXs.js";import{j as _,a as j,B as se}from"./App-XreTAmzn.js";import{h as ne}from"./moment-Cl4UOzQZ.js";import{P}from"./index-D4i6MgDl.js";import{d as He}from"./Assignment-BLk6Qo00.js";import{d as Ne}from"./MoreVert-wroL-zYS.js";import{T as Ve,a as Re,d as le,b as ie}from"./FirstPage-BKQpZ07i.js";import{C as Le}from"./country-UogEiDjg.js";import{C as H,a as Ee}from"./ColorButton-DU_nmFNW.js";import{d as oe}from"./KeyboardArrowLeft-i5DtCEUm.js";import{d as re}from"./KeyboardArrowRight-DTwXVoMT.js";import{u as Ye}from"./useValidation-9lDVHeJg.js";/* empty css                 *//* empty css                                  */import{s as qe}from"./styled-VyqOG4MM.js";import{B as Ge}from"./Backdrop-CfdoqMb9.js";import{C as Ue}from"./CircularProgress-BRq5LZ96.js";import{B as S}from"./Box-BfZ9aPM0.js";import{G as o,u as Je}from"./Grid-CN4_8jt6.js";import{T as k}from"./TextField-Bhii07AO.js";import{T as Ke,a as Qe,b as Xe}from"./TableHead-D-J9IdRc.js";import{P as Ze,a as we}from"./Menu-nsvb1963.js";import{T as A}from"./TableRow-DnKJegd7.js";import{T as b}from"./TableCell-BSK8M-MP.js";import{T as et}from"./TableBody-kXsojO-5.js";import{A as tt}from"./Avatar-DXz0e9-Z.js";import{I as $}from"./IconButton-DdTwUNw0.js";import{M as de}from"./MenuItem-DT3WvV_t.js";import{S as at,O as ce}from"./Select-hHeL8oeK.js";import{F as xe}from"./FormControl-y3ZRJ1PJ.js";import{I as he}from"./InputAdornment-C_wAtMIb.js";import{D as st,a as nt}from"./DialogContent-hdUF_Hv_.js";import{D as lt}from"./DialogTitle-ByvHUd-z.js";import{D as it}from"./DialogContentText-Drqkh9LP.js";import{D as ot}from"./DialogActions-DVGmwLPR.js";import{B as rt}from"./Button-DmrIAVQi.js";import{S as dt}from"./Slide-CWYbY8LO.js";import"./createSvgIcon-DkNK3VsP.js";import"./createSvgIcon-CWJBf_dQ.js";import"./TransitionGroupContext-DCu7Y_zK.js";import"./isMuiElement-C_WCXon2.js";import"./ButtonBase--q0F1ziJ.js";import"./Tablelvl2Context-B2jmvGEu.js";import"./Toolbar-m-EyFJSu.js";import"./index-hqZ_-EZ6.js";import"./utils-vkrW-C7n.js";import"./index-J02NhpFH.js";import"./useSlot-Cu6FmjDI.js";import"./dividerClasses-CL_qDVcm.js";import"./listItemTextClasses-BWrrQlVX.js";import"./Typography-RCjPBWvE.js";const ct=n.forwardRef(function(x,c){return e.jsx(dt,{direction:"up",ref:c,...x})});function pe(d){const x=Je(),{count:c,page:h,rowsPerPage:p,onPageChange:u}=d,v=m=>{u(m,0)},T=m=>{u(m,h-1)},I=m=>{u(m,h+1)},M=m=>{u(m,Math.max(0,Math.ceil(c/p)-1))};return e.jsxs(S,{sx:{flexShrink:0,ml:2.5},children:[e.jsx($,{onClick:v,disabled:h===0,"aria-label":"first page",children:x.direction==="rtl"?e.jsx(le,{}):e.jsx(ie,{})}),e.jsx($,{onClick:T,disabled:h===0,"aria-label":"previous page",children:x.direction==="rtl"?e.jsx(re,{}):e.jsx(oe,{})}),e.jsx($,{onClick:I,disabled:h>=Math.ceil(c/p)-1,"aria-label":"next page",children:x.direction==="rtl"?e.jsx(oe,{}):e.jsx(re,{})}),e.jsx($,{onClick:M,disabled:h>=Math.ceil(c/p)-1,"aria-label":"last page",children:x.direction==="rtl"?e.jsx(ie,{}):e.jsx(le,{})})]})}pe.propTypes={count:P.number.isRequired,onPageChange:P.func.isRequired,page:P.number.isRequired,rowsPerPage:P.number.isRequired};const xt=[{id:"invoices",label:"Invoices",minWidth:170},{id:"date",label:"Payment Date",minWidth:170},{id:"amount",label:"Amount",minWidth:100},{id:"action",label:"Action",minWidth:120}];function ht(d,x,c,h,p,u){return{id:d,clientInfo:x,invoice:c,date:h,currencyText:p,amount:u}}function xa(){var U,J,K,Q,X,Z,w,ee,te,ae;Ye();const d="api",[x,c]=n.useState(!1),[h,p]=n.useState(!1),[u,v]=n.useState(!1);n.useState(""),n.useState(""),n.useState(""),n.useState(""),n.useState(""),n.useState("");const[T,I]=n.useState("");n.useState(""),n.useState(""),n.useState(""),n.useState(Le.getAllCountries()||[]),n.useState([]),n.useState([]);const M=t=>{ve(t),B(null),v(!0)},m=()=>{v(!1),q(!1)},me=()=>{p(!0)},[N,B]=n.useState(null),D=!!N,[ue,ge]=n.useState(""),fe=t=>{var a=t.currentTarget.value.split("-");ge(a[0]),B(t.currentTarget)},V=()=>{B(null)},[l]=Oe(),[z,R]=n.useState(),[W,je]=n.useState([]);_e.useEffect(()=>{L(),be()},[]);const be=async()=>{var a;const t=_(localStorage.getItem("token"));await j.get(`/${d}/v1/manualPayment/unpaidList/${(a=t==null?void 0:t.data)==null?void 0:a.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(s=>{s.data.status=="201"&&je(s.data.data)}).catch(s=>{console.log("error",s)})},L=async()=>{await j.get(`/${d}/v1/manualPayment/list`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(t=>{t.data.status=="201"&&R(t.data.data)}).catch(t=>{console.log("error",t)})};let E=[];E=[z==null?void 0:z.map(t=>{var a,s;return ht(t==null?void 0:t._id,t==null?void 0:t.clientInfo,(s=(a=t==null?void 0:t.invoiceDetails)==null?void 0:a[0])==null?void 0:s.invoice_number,t==null?void 0:t.paymentDate,t==null?void 0:t.amountCurrencyText,t==null?void 0:t.amount)})].sort((t,a)=>t.date<a.date?-1:1);const g=E[0]||[],[F,Y]=n.useState(0),[y,ye]=n.useState(5),Ce=(t,a)=>{console.log(t),Y(a)},ke=t=>{ye(parseInt(t.target.value,10)),Y(0)},O=(t,a)=>{a=="error"?se.error(t,{position:"top-center",autoClose:1900,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}):se.success(t,{position:"top-center",autoClose:1900,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})},Se=async t=>{var s;const a=_(localStorage.getItem("token"));await j.get(`/${d}/v1/client/list/${(s=a==null?void 0:a.data)==null?void 0:s.id}?title=${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(r=>{r.data.status=="201"&&R(r.data.data)}).catch(r=>{console.log("error",r)})},[pt,q]=n.useState(""),[f,$e]=n.useState(""),ve=async t=>{await j.get(`/${d}/v1/manualPayment/${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{var s,r;((s=a==null?void 0:a.data)==null?void 0:s.status)==201&&$e((r=a==null?void 0:a.data)==null?void 0:r.data)}).catch(a=>{var s,r;O((r=(s=a==null?void 0:a.response)==null?void 0:s.data)==null?void 0:r.message,"error"),console.log("error",a)})},Pe=qe("div")(({theme:t})=>({display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"right",height:"100%","& .ant-empty-img-1":{fill:t.palette.mode==="light"?"#aeb8c2":"#262626"},"& .ant-empty-img-2":{fill:t.palette.mode==="light"?"#f5f5f7":"#595959"},"& .ant-empty-img-3":{fill:t.palette.mode==="light"?"#dce0e6":"#434343"},"& .ant-empty-img-4":{fill:t.palette.mode==="light"?"#fff":"#1c1c1c"},"& .ant-empty-img-5":{fillOpacity:t.palette.mode==="light"?"0.8":"0.08",fill:t.palette.mode==="light"?"#f5f5f5":"#fff"}}));function Ae(){return e.jsxs(Pe,{children:[e.jsx("svg",{width:"120",height:"100",viewBox:"0 0 184 152","aria-hidden":!0,focusable:"false",children:e.jsxs("g",{fill:"none",fillRule:"evenodd",children:[e.jsxs("g",{transform:"translate(24 31.67)",children:[e.jsx("ellipse",{className:"ant-empty-img-5",cx:"67.797",cy:"106.89",rx:"67.797",ry:"12.668"}),e.jsx("path",{className:"ant-empty-img-1",d:"M122.034 69.674L98.109 40.229c-1.148-1.386-2.826-2.225-4.593-2.225h-51.44c-1.766 0-3.444.839-4.592 2.225L13.56 69.674v15.383h108.475V69.674z"}),e.jsx("path",{className:"ant-empty-img-2",d:"M33.83 0h67.933a4 4 0 0 1 4 4v93.344a4 4 0 0 1-4 4H33.83a4 4 0 0 1-4-4V4a4 4 0 0 1 4-4z"}),e.jsx("path",{className:"ant-empty-img-3",d:"M42.678 9.953h50.237a2 2 0 0 1 2 2V36.91a2 2 0 0 1-2 2H42.678a2 2 0 0 1-2-2V11.953a2 2 0 0 1 2-2zM42.94 49.767h49.713a2.262 2.262 0 1 1 0 4.524H42.94a2.262 2.262 0 0 1 0-4.524zM42.94 61.53h49.713a2.262 2.262 0 1 1 0 4.525H42.94a2.262 2.262 0 0 1 0-4.525zM121.813 105.032c-.775 3.071-3.497 5.36-6.735 5.36H20.515c-3.238 0-5.96-2.29-6.734-5.36a7.309 7.309 0 0 1-.222-1.79V69.675h26.318c2.907 0 5.25 2.448 5.25 5.42v.04c0 2.971 2.37 5.37 5.277 5.37h34.785c2.907 0 5.277-2.421 5.277-5.393V75.1c0-2.972 2.343-5.426 5.25-5.426h26.318v33.569c0 .617-.077 1.216-.221 1.789z"})]}),e.jsx("path",{className:"ant-empty-img-3",d:"M149.121 33.292l-6.83 2.65a1 1 0 0 1-1.317-1.23l1.937-6.207c-2.589-2.944-4.109-6.534-4.109-10.408C138.802 8.102 148.92 0 161.402 0 173.881 0 184 8.102 184 18.097c0 9.995-10.118 18.097-22.599 18.097-4.528 0-8.744-1.066-12.28-2.902z"}),e.jsxs("g",{className:"ant-empty-img-4",transform:"translate(149.65 15.383)",children:[e.jsx("ellipse",{cx:"20.654",cy:"3.167",rx:"2.849",ry:"2.815"}),e.jsx("path",{d:"M5.698 5.63H0L2.898.704zM9.259.704h4.985V5.63H9.259z"})]})]})}),e.jsx(S,{sx:{mt:1},children:"No Data found"})]})}n.useState("");const[Te,Ie]=n.useState(""),[Me,Be]=n.useState(0),De=async()=>{var a;c(!0);const t=_(localStorage.getItem("token"));await j.post(`/${d}/v1/manualPayment/add`,{user:(a=t==null?void 0:t.data)==null?void 0:a.id,invoice:i==null?void 0:i._id,client:i==null?void 0:i.userid,invoice_number:Te,dueAmount:i==null?void 0:i.dueAmount,amountCurrencyText:i==null?void 0:i.currency_text,paidAmount:i==null?void 0:i.paidAmount,amount:Me,notes:T,payment_date:new Date().toISOString().substring(0,10),mode:"Cash"},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(s=>{var r;s.data.status=="201"&&(c(!1),p(!1),O((r=s==null?void 0:s.data)==null?void 0:r.message,"Success"),L())}).catch(s=>{var r,C;c(!1),O((C=(r=s==null?void 0:s.response)==null?void 0:r.data)==null?void 0:C.message,"error"),console.log("error",s)})},ze=()=>{p(!1),q(!1)},We=()=>{p(!1),G([])},[i,G]=n.useState([]),Fe=async t=>{await j.get(`/${d}/v1/invoice/getinv/info/${t}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(a=>{var s,r;((s=a==null?void 0:a.data)==null?void 0:s.status)=="201"&&(Ie(t),G((r=a==null?void 0:a.data)==null?void 0:r.data))}).catch(a=>{console.log("error",a)})};return e.jsxs(e.Fragment,{children:[e.jsx(Ge,{sx:{color:"#fff",zIndex:t=>t.zIndex.drawer+1},open:x,onClick:V,children:e.jsx(Ue,{color:"inherit"})}),e.jsx(S,{sx:{marginTop:{xs:"-12px",md:"12px"},fontSize:"15px"},children:e.jsx(o,{sx:{display:"flex",flexDirection:"column",gap:"1px",borderRadius:".5rem",color:"black",fontWeight:"700",background:{xs:`${l?"#183153":"white"}`,sm:`${l?"":"white"}`},border:{xs:`${l?"1px solid white":"white"}`,sm:`${l?"1px solid white":"white"}`},padding:"3px"},children:h?e.jsxs(e.Fragment,{children:[e.jsx(o,{sx:{display:"flex",flexDirection:"row",justifyContent:"flex-end",margin:"2%"},children:e.jsx(o,{children:e.jsx(H,{onClick:()=>We(),children:"Back"})})}),e.jsxs(o,{container:!0,spacing:2,sx:{padding:"2%",color:`${l?"white":"black"}`},children:[e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx("label",{htmlFor:"Invoice",children:"Invoice"}),e.jsx(at,{onChange:t=>Fe(t.target.value),sx:{color:`${l?"white":"black"}`,border:`${l?"1px solid silver":"black"}`},fullWidth:!0,children:W==null?void 0:W.map((t,a)=>e.jsx(de,{value:t==null?void 0:t.invoice_number,sx:{color:`${l?"white":"black"}`},children:t==null?void 0:t.invoice_number},a))})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx("label",{htmlFor:"Due Amount",children:"Due Amount "}),e.jsx(xe,{fullWidth:!0,children:e.jsx(ce,{id:"paid-amount",sx:{border:`${l?"1px solid silver":"black"}`},startAdornment:e.jsx(he,{position:"start",children:(i==null?void 0:i.currency_text)||""}),value:(i==null?void 0:i.dueAmount)||0})})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx("label",{htmlFor:"Paid Amount",children:"Paid Amount "}),e.jsx(xe,{fullWidth:!0,children:e.jsx(ce,{id:"paid-amount",sx:{border:`${l?"1px solid silver":"black"}`,color:`${l?"white":"black"}`},startAdornment:e.jsx(he,{position:"start",sx:{color:`${l?"white":"black"}`},children:e.jsx("span",{style:{color:`${l?"white":"black"}`},children:(i==null?void 0:i.currency_text)||""})}),value:(i==null?void 0:i.paidAmount)||0})})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx("label",{htmlFor:"Payment Date",children:"Payment Date "}),e.jsx(k,{placeholder:"Payment Date",value:new Date().toISOString().substring(0,10),sx:{color:`${l?"white":"black"}`,border:`${l?"1px solid silver":"black"}`},fullWidth:!0})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsxs("label",{htmlFor:"Amount",children:["Amount ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(k,{placeholder:"Amount",onChange:t=>Be(t.target.value),sx:{border:`${l?"1px solid silver":"black"}`},fullWidth:!0})]}),e.jsxs(o,{item:!0,xs:12,md:6,children:[e.jsx("label",{htmlFor:"Payment Mode",children:"Payment Mode "}),e.jsx(k,{placeholder:"Payment Mode",value:"Cash",sx:{color:"black",border:`${l?"1px solid silver":"black"}`},fullWidth:!0})]}),e.jsxs(o,{item:!0,xs:12,md:12,children:[e.jsxs("label",{htmlFor:"Notes",children:["Notes ",e.jsx("sup",{style:{fontSize:"19px",color:"red",fontWeight:"900"}})]}),e.jsx(k,{placeholder:"Notes",onChange:t=>I(t.target.value),sx:{border:`${l?"1px solid silver":"black"}`},multiline:!0,rows:7,fullWidth:!0})]}),e.jsx(o,{item:!0,xs:12,children:e.jsxs(o,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between"},children:[e.jsx(o,{children:e.jsx(H,{onClick:De,children:"Pay"})}),e.jsx(o,{children:e.jsx(Ee,{onClick:()=>confirm("Are you sure?")?ze():"",children:"Cancel"})})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(o,{sx:{display:"flex",justifyContent:"space-between",flexWrap:"wrap",margin:"1%"},children:[e.jsx(o,{children:e.jsx(k,{onChange:t=>Se(t.target.value),placeholder:"Search",sx:{border:`${l?"1px solid silver":"black"}`,width:"190px"}})}),e.jsx(o,{children:e.jsx(H,{sx:{marginBottom:" 12px",padding:"15px"},onClick:me,children:"+"})})]}),e.jsx(S,{sx:{overflow:"auto"},children:e.jsx(S,{sx:{width:"100%",display:"table",tableLayout:"fixed"},children:e.jsx(Ke,{component:Ze,children:e.jsxs(Qe,{sx:{minWidth:500},"aria-label":"custom pagination table",children:[e.jsxs("div",{children:[e.jsx(Xe,{children:e.jsx(A,{className:`${l?"avatarDark":"avatarLight"}`,children:xt.map(t=>e.jsx(b,{width:"360",style:{padding:"12px",background:"#8657E5",color:"white"},children:t.label},t.id))})}),e.jsxs(et,{children:[(y>0?g==null?void 0:g.slice(F*y,F*y+y):g).map(t=>{var a,s,r,C;return e.jsxs(A,{children:[e.jsx(b,{style:{padding:"6px",fontSize:"14px",fontWeight:"400"},scope:"row",children:e.jsxs(o,{sx:{display:"flex",flexDirection:"row",gap:"12px"},children:[e.jsx(o,{sx:{display:{xs:"none",md:"flex"},flexDirection:"row",alignItems:"center"},children:e.jsx(tt,{sx:{color:"white",background:"#8657E5"},children:e.jsx(He,{})})}),e.jsxs(o,{sx:{display:"flex",flexDirection:"column"},children:[e.jsxs(o,{children:[(s=(a=t==null?void 0:t.clientInfo)==null?void 0:a[0])==null?void 0:s.name," ",e.jsx("span",{children:t==null?void 0:t.invoice})]}),e.jsx(o,{children:(C=(r=t==null?void 0:t.clientInfo)==null?void 0:r[0])==null?void 0:C.email})]})]})}),e.jsx(b,{style:{padding:"12px",fontSize:"14px",fontWeight:"400"},scope:"row",children:ne(t==null?void 0:t.date).format("DD-MM-YYYY")}),e.jsxs(b,{style:{padding:"12px",fontSize:"14px",fontWeight:"400"},scope:"row",children:[t==null?void 0:t.currencyText,t==null?void 0:t.amount]}),e.jsx(b,{style:{padding:"12px",fontSize:"14px",fontWeight:"400"},scope:"row",children:e.jsx(o,{sx:{display:"flex",flexDirection:"row",justifyContent:"normal"},children:e.jsxs(o,{children:[e.jsx($,{"aria-label":"more",value:`${t==null?void 0:t.id}-${t==null?void 0:t.status}-${t==null?void 0:t.recurring}-${t==null?void 0:t.invoice_number}-${t==null?void 0:t.createdBy}`,id:`long-button${t==null?void 0:t.id}`,"aria-controls":D?`long-menu${t==null?void 0:t.id}`:void 0,"aria-expanded":D?"true":void 0,"aria-haspopup":"true",sx:{color:`${l?"white":"black"}`},onClick:fe,children:e.jsx(Ne,{})}),e.jsx(we,{id:`long-menu${t==null?void 0:t.id}`,MenuListProps:{"aria-labelledby":`long-button${t==null?void 0:t.id}`},anchorEl:N,open:D,onClose:V,children:e.jsx(de,{onClick:()=>M(ue),children:e.jsx("span",{className:`${l?"avatarDarkSecondaryExtra":"avatarLight"}`,children:"View"})})},t==null?void 0:t.id)]})})})]},t==null?void 0:t.date)}),(g==null?void 0:g.length)==0&&e.jsx(A,{children:e.jsx(b,{colSpan:7,children:e.jsx(Ae,{})})})]})]}),e.jsx(Ve,{sx:{background:`${l?"white":""}`},children:e.jsx(A,{children:e.jsx(Re,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:7,count:g.length,rowsPerPage:y,page:F,slotProps:{select:{inputProps:{"aria-label":"rows per page"},native:!0}},sx:{color:"black"},onPageChange:Ce,onRowsPerPageChange:ke,ActionsComponent:pe})})})]})})})})]})})}),e.jsxs(st,{fullWidth:!0,maxWidth:"md",open:u,TransitionComponent:ct,keepMounted:!0,onClose:m,"aria-describedby":"alert-dialog-slide-description",children:[e.jsx(lt,{sx:{color:`${l?"white":"black"}`},children:"Transaction Details"}),e.jsx(nt,{children:e.jsx(it,{id:"alert-dialog-slide-description",children:e.jsx("table",{width:"100%",border:1,style:{borderCollapse:"collapse",color:`${l?"white":"black"}`},children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"12px"},children:"Name"}),e.jsx("td",{style:{padding:"12px"},children:(K=(J=(U=f[0])==null?void 0:U.clientInfo)==null?void 0:J[0])==null?void 0:K.name})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"12px"},children:"Email"}),e.jsx("td",{style:{padding:"12px"},children:(Z=(X=(Q=f[0])==null?void 0:Q.clientInfo)==null?void 0:X[0])==null?void 0:Z.email})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"12px"},children:"Amount"}),e.jsxs("td",{style:{padding:"12px"},children:[(w=f[0])==null?void 0:w.amountCurrencyText,(ee=f[0])==null?void 0:ee.amount]})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"12px"},children:"Payment Date"}),e.jsx("td",{style:{padding:"12px"},children:ne((te=f[0])==null?void 0:te.paymentDate).format("DD-MM-YYYY")})]}),e.jsxs("tr",{children:[e.jsx("td",{style:{padding:"12px"},children:"Notes"}),e.jsx("td",{style:{padding:"12px"},children:(ae=f[0])==null?void 0:ae.notes})]})]})})})}),e.jsx(ot,{children:e.jsx(rt,{onClick:m,sx:{color:`${l?"white":"black"}`},children:"Close"})})]})]})}export{xa as default};

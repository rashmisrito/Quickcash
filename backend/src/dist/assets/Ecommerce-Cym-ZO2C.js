import{k as F,u as A,R as s,r as h,j as t}from"./index-BoluCWJx.js";import{a as x}from"./App-DmzB4KYc.js";import{O as T}from"./index-0exdDNLS.js";/* empty css                        */import{C as g}from"./ColorButton-DVQMk-mO.js";import{d as N}from"./ArrowBackIosRounded-R8ElViWG.js";import{B as R}from"./Backdrop-BiRxOpLA.js";import{C as V}from"./CircularProgress-DpQfCBCz.js";import{B as b}from"./Box-B48tCTAh.js";import{T as G}from"./Typography-DPkJNBsU.js";import{G as c}from"./Grid-CDAIVjPl.js";import{C as O}from"./CardContent-DQEMBR3E.js";import{S as U}from"./Stack-CPSNaoGK.js";import{T as l}from"./TextField-BjXLReKG.js";import"./styled-BE7uoR5C.js";import"./Button-CGTIOcYX.js";import"./ButtonBase-Cc0NCTY7.js";import"./TransitionGroupContext-D5Gal4xy.js";import"./createSvgIcon-DDiySQ4J.js";import"./createSvgIcon-i4Ddu0pI.js";import"./isMuiElement-Bzzx93h0.js";import"./utils-PFTex4TT.js";import"./styled-C0obRrxL.js";import"./createStyled-B6TKEMzY.js";import"./FormControl-BiEJnuIY.js";import"./Select-aus-Z7PH.js";import"./Menu-BmC6YJiv.js";function he(){const r=F(),y=A(),[j,m]=s.useState(!1),[C,k]=s.useState(0),[v,D]=s.useState(""),[S,I]=s.useState(),p="api";h.useEffect(()=>{$()},[r==null?void 0:r.id]);const w=()=>{m(!0)},[a,u]=s.useState({number:"",expiry:"",cvc:"",name:"",focus:""});h.useEffect(()=>{P()},[]);const P=async()=>{await x.post(`/${p}/v1/user/auth`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(e=>{e.data.status==201&&I(e.data.data)}).catch(e=>{console.log(e)})},$=async()=>{await x.get(`/${p}/v1/ecommerce/${r==null?void 0:r.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(e=>{e.data.status=="201"&&(k(e.data.data.amount),D(e.data.data.currency))}).catch(e=>{console.log("error",e)})},z=async()=>{a.name==""||a.number==""||a.expiry==""||a.cvc==""?alert("Please fill all of the fields"):(m(!0),await x.post(`/${p}/v1/itiopay/pay`,{userData:S,amount:C,currency:v,cardsDetails:a}).then(e=>{e.data.status==201&&(window.location.href=`${e.data.data}`)}).catch(e=>{m(!1),console.log(e)}))},n=e=>{const{name:o,value:f}=e.target;if(o=="expiry"){const d=L(f);u(B=>({...B,[o]:d}))}else u(d=>({...d,[o]:f}))};function E(e=""){return e.replace(/\D+/g,"")}function L(e){const o=E(e);return o.length>=3?`${o.slice(0,2)}/${o.slice(2,4)}`:o}const i=e=>{u(o=>({...o,focus:e.target.name}))};return t.jsxs(t.Fragment,{children:[t.jsx(R,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:j,onClick:w,children:t.jsx(V,{color:"inherit"})}),t.jsxs(b,{sx:{marginTop:{md:"1px"}},children:[t.jsx(G,{children:t.jsx(g,{onClick:()=>y("/ecommerce/list"),sx:{marginBottom:"20px"},children:t.jsxs(c,{sx:{display:"flex",flexDirection:"row",gap:"12px"},children:[t.jsx(c,{children:t.jsx(N,{})}),t.jsx(c,{children:"back"})]})})}),t.jsx(c,{sx:{display:"flex",flexDirection:"row",borderLeft:"3px solid #5DADE2",borderRight:"3px solid #5DADE2",justifyContent:"center",padding:"10px",borderRadius:"12px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.6)"},children:t.jsxs(O,{component:U,spacing:3,sx:{height:"auto",justifyContent:"center",padding:0},children:[t.jsx(T,{number:a.number,expiry:a.expiry,cvc:a.cvc,name:a.name}),t.jsx(l,{label:"Name",name:"name",type:"text",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:a.name,onChange:n,onFocus:i,placeholder:"Name"}),t.jsx(l,{label:"Card Number",name:"number",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},inputProps:{maxLength:16},value:a.number,onChange:n,onFocus:i}),t.jsxs(b,{sx:{display:"flex",gap:3},children:[t.jsx(l,{label:"CVV",name:"cvc",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:a.cvc,onChange:n,onFocus:i,inputProps:{maxLength:3}}),t.jsx(l,{label:"Expiry Date",name:"expiry",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:a.expiry,onChange:n,onFocus:i,inputProps:{maxLength:5,min:`${new Date().toISOString().split("T")[0]}`}})]}),t.jsx(g,{size:"large",sx:{fontWeight:"bold"},onClick:()=>z(),children:"Submit"})]})})]})]})}export{he as default};

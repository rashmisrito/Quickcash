import{k as F,u as A,R as s,r as h,j as t}from"./index-CPyIBKv5.js";import{a as x}from"./App-CPA_Lu-d.js";import{O as T}from"./index-POF-J6JS.js";/* empty css                        */import{C as g}from"./ColorButton-p_8AmmsY.js";import{d as N}from"./ArrowBackIosRounded-C8TdMC0t.js";import{B as R}from"./Backdrop-5VrCmbBJ.js";import{C as U}from"./CircularProgress-CnrtTxNb.js";import{B as y}from"./Box-Cts58nYT.js";import{T as V}from"./Typography-32GqnDkD.js";import{G as c}from"./Grid-ijiQ2gXa.js";import{C as G}from"./CardContent-HJEbaaBe.js";import{S as O}from"./Stack-BWb2LFok.js";import{T as l}from"./TextField-CGe-lY_w.js";import"./styled-D3btvjLo.js";import"./Button-mU0fsZ6C.js";import"./ButtonBase-lj8ryPQQ.js";import"./TransitionGroupContext-DpwKRQDB.js";import"./createSvgIcon-DK6HOpVs.js";import"./createSvgIcon-CJCtbkVa.js";import"./isMuiElement-CtMSz7xH.js";import"./utils-27lUOG69.js";import"./styled-CqkSbG4E.js";import"./createStyled-BMiToX-t.js";import"./FormControl-Cfr3bcUw.js";import"./Select-Cu2oDfAu.js";import"./Menu-DzGOcUhD.js";function ye(){const o=F(),b=A(),[j,C]=s.useState(0),[H,k]=s.useState(""),[v,m]=s.useState(!1),[W,D]=s.useState([]),[S,I]=s.useState(),p="api";h.useEffect(()=>{P()},[o==null?void 0:o.id]);const w=()=>{m(!0)},[a,u]=s.useState({number:"",expiry:"",cvc:"",name:"",focus:""});h.useEffect(()=>{E()},[]);const E=async()=>{await x.post(`/${p}/v1/user/auth`,{},{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(e=>{e.data.status==201&&I(e.data.data)}).catch(e=>{console.log(e)})},P=async()=>{await x.get(`/${p}/v1/ecommerce/${o==null?void 0:o.id}`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}).then(e=>{e.data.status=="201"&&(C(e.data.data.amount),k(e.data.data.currency))}).catch(e=>{console.log("error",e)})},$=async()=>{a.name==""||a.number==""||a.expiry==""||a.cvc==""?alert("Please fill all of the fields"):(m(!0),await x.post(`/${p}/v1/itiopay/pay`,{userData:S,amount:j,currency:"USD",cardsDetails:a}).then(e=>{e.data.status==201&&(window.location.href=`${e.data.data}`)}).catch(e=>{m(!1),console.log(e)}))},n=e=>{D([]);const{name:r,value:f}=e.target;if(r=="expiry"){const d=L(f);u(B=>({...B,[r]:d}))}else u(d=>({...d,[r]:f}))};function z(e=""){return e.replace(/\D+/g,"")}function L(e){const r=z(e);return r.length>=3?`${r.slice(0,2)}/${r.slice(2,4)}`:r}const i=e=>{u(r=>({...r,focus:e.target.name}))};return t.jsxs(t.Fragment,{children:[t.jsx(R,{sx:{color:"#fff",zIndex:e=>e.zIndex.drawer+1},open:v,onClick:w,children:t.jsx(U,{color:"inherit"})}),t.jsxs(y,{sx:{marginTop:{md:"1px"}},children:[t.jsx(V,{children:t.jsx(g,{onClick:()=>b("/ecommerce/list"),sx:{marginBottom:"20px"},children:t.jsxs(c,{sx:{display:"flex",flexDirection:"row",gap:"12px"},children:[t.jsx(c,{children:t.jsx(N,{})}),t.jsx(c,{children:"back"})]})})}),t.jsx(c,{sx:{display:"flex",flexDirection:"row",borderLeft:"3px solid #5DADE2",borderRight:"3px solid #5DADE2",justifyContent:"center",padding:"10px",borderRadius:"12px",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.6)"},children:t.jsxs(G,{component:O,spacing:3,sx:{height:"auto",justifyContent:"center",padding:0},children:[t.jsx(T,{number:a.number,expiry:a.expiry,cvc:a.cvc,name:a.name}),t.jsx(l,{label:"Name",name:"name",type:"text",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:a.name,onChange:n,onFocus:i,placeholder:"Name"}),t.jsx(l,{label:"Card Number",name:"number",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},inputProps:{maxLength:16},value:a.number,onChange:n,onFocus:i}),t.jsxs(y,{sx:{display:"flex",gap:3},children:[t.jsx(l,{label:"CVV",name:"cvc",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:a.cvc,onChange:n,onFocus:i,inputProps:{maxLength:3}}),t.jsx(l,{label:"Expiry Date",name:"expiry",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:a.expiry,onChange:n,onFocus:i,inputProps:{maxLength:5,min:`${new Date().toISOString().split("T")[0]}`}})]}),t.jsx(g,{size:"large",sx:{fontWeight:"bold"},onClick:()=>$(),children:"Submit"})]})})]})]})}export{ye as default};

import{u,c as l,r as aa,j as Q}from"./index-CoE2VX6x.js";import{j as ta,a as V,g as W,B as X}from"./App-7Jvq8VZr.js";function na(){const Y=u(),d="api",n=l().search,o=ta(localStorage.getItem("token"));aa.useEffect(()=>{const t=new URLSearchParams(n).get("payment_intent"),e=new URLSearchParams(n).get("redirect_status");t&&e&&I(t,e)},[]);const Z=(t,e)=>{e=="error"?X.error(t,{position:"top-left",autoClose:7e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}):X.success(t,{position:"top-center",autoClose:7e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})},I=async(t,e)=>{await V.post(`/${d}/v1/stripe/fetch`,{transaction_id:new URLSearchParams(n).get("payment_intent")}).then(async a=>{var m,i,r,s,p,f,g,h,y,v,S,_,x,w,P,j,$,A,C,O,R,b,D,F,L,k,B,E,N,T,U,H,q,z,G,J,K,M;a.data.status==201&&await V.post(`/${d}/v1/stripe/complete-addmoney`,{user:(m=o==null?void 0:o.data)==null?void 0:m.id,status:e,orderDetails:t,userData:(i=o==null?void 0:o.data)==null?void 0:i.name,account:(p=(s=(r=a==null?void 0:a.data)==null?void 0:r.data)==null?void 0:s.metadata)==null?void 0:p.account,amount:parseFloat((h=(g=(f=a==null?void 0:a.data)==null?void 0:f.data)==null?void 0:g.metadata)==null?void 0:h.amount),fee:parseFloat((S=(v=(y=a==null?void 0:a.data)==null?void 0:y.data)==null?void 0:v.metadata)==null?void 0:S.fee),amountText:(w=(x=(_=a==null?void 0:a.data)==null?void 0:_.data)==null?void 0:x.metadata)!=null&&w.amount?`${W(($=(j=(P=a==null?void 0:a.data)==null?void 0:P.data)==null?void 0:j.metadata)==null?void 0:$.from_currency)}${(O=(C=(A=a==null?void 0:a.data)==null?void 0:A.data)==null?void 0:C.metadata)==null?void 0:O.amount}`:"",from_currency:(D=(b=(R=a==null?void 0:a.data)==null?void 0:R.data)==null?void 0:b.metadata)==null?void 0:D.from_currency,to_currency:(k=(L=(F=a==null?void 0:a.data)==null?void 0:F.data)==null?void 0:L.metadata)==null?void 0:k.to_currency,convertedAmount:parseFloat((N=(E=(B=a==null?void 0:a.data)==null?void 0:B.data)==null?void 0:E.metadata)==null?void 0:N.convertedAmount),conversionAmountText:(H=(U=(T=a==null?void 0:a.data)==null?void 0:T.data)==null?void 0:U.metadata)!=null&&H.convertedAmount?`${W((G=(z=(q=a==null?void 0:a.data)==null?void 0:q.data)==null?void 0:z.metadata)==null?void 0:G.to_currency)}${(M=(K=(J=a==null?void 0:a.data)==null?void 0:J.data)==null?void 0:K.metadata)==null?void 0:M.convertedAmount}`:""}).then(c=>{c.data.status==201&&(Z("Payment has been done Successfully","Success"),setTimeout(()=>{Y("/home")},100))}).catch(c=>{console.log(c)})}).catch(a=>{console.log(a)})};return Q.jsx("div",{className:"yo",children:Q.jsx("div",{className:"card",children:"Stripe Payment is processing , please wait ..."})})}export{na as default};

import{c as G,u as J,R as o,r as Q,j as t,L as U}from"./index-BoluCWJx.js";import{a as j,B as k,g as Y}from"./App-DmzB4KYc.js";import{C as D}from"./index-B0ntxUyL.js";import{O as _}from"./index-0exdDNLS.js";/* empty css                        */import{C as q}from"./ColorButton-DVQMk-mO.js";import{B as K}from"./Backdrop-BiRxOpLA.js";import{C as M}from"./CircularProgress-DpQfCBCz.js";import{G as r}from"./Grid-CDAIVjPl.js";import{C as P}from"./CardContent-DQEMBR3E.js";import{T as u}from"./Typography-DPkJNBsU.js";import{S as X}from"./Stack-CPSNaoGK.js";import{T as p}from"./TextField-BjXLReKG.js";import{B as Z}from"./Box-B48tCTAh.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./styled-BE7uoR5C.js";import"./Button-CGTIOcYX.js";import"./ButtonBase-Cc0NCTY7.js";import"./TransitionGroupContext-D5Gal4xy.js";import"./utils-PFTex4TT.js";import"./styled-C0obRrxL.js";import"./createStyled-B6TKEMzY.js";import"./FormControl-BiEJnuIY.js";import"./Select-aus-Z7PH.js";import"./Menu-BmC6YJiv.js";import"./createSvgIcon-i4Ddu0pI.js";import"./isMuiElement-Bzzx93h0.js";function ee(i){return t.jsxs(u,{variant:"body2",color:"text.secondary",align:"center",...i,children:["Copyright Â© ",t.jsx(U,{color:"inherit",to:"/",style:{textDecoration:"none"},children:"Quick Cash"})," ",new Date().getFullYear(),"."]})}function ze(){const i=G();var I=i==null?void 0:i.pathname.replace("/payment/","");const x="api";var $=D.AES.decrypt(I,"ganesh"),h=$.toString(D.enc.Utf8);const n=J(),[c,N]=o.useState(""),[v,z]=o.useState(0),[C,L]=o.useState(""),[te,f]=o.useState(!1),[w,F]=o.useState(""),[ae,T]=o.useState([]);Q.useEffect(()=>{B()},[h]);const[s,y]=o.useState({number:"",expiry:"",cvc:"",name:"",focus:"",zipcode:""}),B=async()=>{var a=h.split("-");await j.get(`/${x}/v1/ecommerce/frontend/${a[1]}`).then(e=>{e.data.status=="201"&&(z(e.data.data.amount),F(e.data.data.dueDate),L(e.data.data.currency),N(e.data.data.status))}).catch(e=>{console.log("error",e),g(e.response.data.message,"error")})},[E,S]=o.useState(!1),O=()=>{S(!1)},R=async a=>{S(!0),await j.get(`/${x}/v1/itiopay/status/${a}`).then(e=>{e.data.status==201&&(e.data.data==0||(e.data.data==1?n(`/response/${a}`):e.data.data==2?n(`/response/${a}`):e.data.data==9?n(`/response/${a}`):e.data.data==22?n(`/response/${a}`):e.data.data==23?n(`/response/${a}`):e.data.data==24&&n(`/response/${a}`)))}).catch(e=>{f(!1),g(e.response.data.data,"error"),console.log(e)})},A=async()=>{s.name==""||s.number==""||s.expiry==""||s.cvc==""||s.zipcode==""?alert("Please fill all of the fields"):(f(!0),await j.post(`/${x}/v1/itiopay/pay`,{user:h,amount:v,currency:C,cardsDetails:s}).then(a=>{if(a.data.status==201){localStorage.setItem("transID",a.data.transID),window.open(`${a.data.data}`,"_blank");var e=0,m=setInterval(function(){e+=1,e===20&&clearInterval(m),R(a.data.transID)},2e3)}}).catch(a=>{f(!1),g(a.response.data.data,"error"),console.log(a)}))},g=(a,e)=>{e=="error"?k.error(a,{position:"top-center",autoClose:6e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"}):k.success(a,{position:"top-center",autoClose:6e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0,progress:void 0,theme:"colored"})},l=a=>{T([]);const{name:e,value:m}=a.target;if(e=="expiry"){const b=H(m);y(V=>({...V,[e]:b}))}else y(b=>({...b,[e]:m}))};function W(a=""){return a.replace(/\D+/g,"")}function H(a){const e=W(a);return e.length>=3?`${e.slice(0,2)}/${e.slice(2,4)}`:e}const d=a=>{y(e=>({...e,focus:a.target.name}))};return t.jsxs("div",{style:{marginTop:"79px"},children:[t.jsxs(K,{sx:{color:"#fff",zIndex:a=>a.zIndex.drawer+1},open:E,onClick:O,children:[t.jsx(M,{color:"inherit"})," Processing..."]}),c=="unpaid"&&t.jsxs(r,{container:!0,spacing:2,children:[t.jsx(r,{item:!0,xs:1}),t.jsx(r,{item:!0,xs:12,sm:5,children:t.jsx(r,{sx:{borderRadius:"12px",height:"100%"},children:t.jsxs(P,{children:[t.jsx(u,{variant:"h3",color:"text.secondary",sx:{fontFamily:"mono"},gutterBottom:!0,children:"Payment Summary"}),t.jsx(r,{sx:{display:"flex",flexDirection:"column",justifyContent:"space-between"},children:t.jsxs(r,{sx:{marginTop:"12px"},children:[t.jsxs(u,{variant:"h5",sx:{fontFamily:"mono"},children:["Amount: ",Y(C),v]}),t.jsxs(u,{variant:"h5",sx:{fontFamily:"mono"},children:["Due Date: ",w]})]})})]})})}),t.jsx(r,{item:!0,xs:12,sm:5,children:t.jsxs(P,{component:X,spacing:3,sx:{height:"auto",boxShadow:"0 4px 8px 0 rgba(0, 0, 0, 0.3)",justifyContent:"center",padding:"29px",borderRadius:"12px"},children:[t.jsx(_,{number:s.number,expiry:s.expiry,cvc:s.cvc,name:s.name}),t.jsx(p,{label:"Name",name:"name",type:"text",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.name,onChange:l,onFocus:d,placeholder:"Name"}),t.jsx(p,{label:"Card Number",name:"number",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},inputProps:{maxLength:16},value:s.number,onChange:l,onFocus:d}),t.jsxs(Z,{sx:{display:"flex",gap:3},children:[t.jsx(p,{fullWidth:!0,label:"CVV",name:"cvc",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.cvc,onChange:l,onFocus:d,inputProps:{maxLength:3}}),t.jsx(p,{fullWidth:!0,label:"Expiry Date",name:"expiry",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.expiry,onChange:l,onFocus:d,inputProps:{maxLength:5,min:`${new Date().toISOString().split("T")[0]}`}}),t.jsx(p,{fullWidth:!0,label:"Postal Code",name:"zipcode",type:"tel",size:"medium",InputLabelProps:{shrink:!0,style:{color:"black"}},value:s.zipcode,onChange:l,inputProps:{maxLength:6}})]}),t.jsx(q,{size:"large",sx:{fontWeight:"bold"},onClick:()=>A(),children:"Proceed to pay"})]})})]}),c=="pending"||c=="Test"||c=="approved"||c=="paid"?t.jsx(r,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",padding:"16px",fontSize:"30px"},children:t.jsx("div",{className:"card",children:t.jsxs("div",{className:"header",children:[t.jsxs("div",{className:"content",children:[t.jsx("span",{className:"title",children:"Payment Already done"}),t.jsx("p",{className:"message",children:"Thank you for payment."})]}),t.jsx("div",{className:"actions",children:t.jsx("button",{type:"button",className:"history",children:"Neo Connect"})})]})})}):null,t.jsx(ee,{sx:{mt:8,mb:4}})]})}export{ze as default};

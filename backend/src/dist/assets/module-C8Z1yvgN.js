import d from"./html2canvas.esm-3NQT9CgR.js";import{r as p}from"./index-D-Z3PEJc.js";import{E as m}from"./jspdf.es.min-BtRBSGjN.js";const g=3.77952755906;let h;(function(t){t[t.LOW=1]="LOW",t[t.NORMAL=2]="NORMAL",t[t.MEDIUM=3]="MEDIUM",t[t.HIGH=7]="HIGH",t[t.EXTREME=12]="EXTREME"})(h||(h={}));let o;(function(t){t[t.NONE=0]="NONE",t[t.SMALL=5]="SMALL",t[t.MEDIUM=10]="MEDIUM",t[t.LARGE=25]="LARGE"})(o||(o={}));const r={method:"save",resolution:h.MEDIUM,page:{margin:o.NONE,format:"A4",orientation:"portrait"},canvas:{mimeType:"image/jpeg",qualityRatio:1,useCORS:!0,logging:!1},overrides:{}};class M{constructor(e,a){var i;this.canvas=e,this.options=a,this.pdf=new m({format:this.options.page.format,orientation:this.options.page.orientation,...(i=this.options.overrides)==null?void 0:i.pdf,unit:"mm"})}getMarginTopMM(){const e=typeof this.options.page.margin=="object"?this.options.page.margin.top:this.options.page.margin;return Number(e)}getMarginLeftMM(){const e=typeof this.options.page.margin=="object"?this.options.page.margin.left:this.options.page.margin;return Number(e)}getMarginRightMM(){const e=typeof this.options.page.margin=="object"?this.options.page.margin.right:this.options.page.margin;return Number(e)}getMarginBottomMM(){const e=typeof this.options.page.margin=="object"?this.options.page.margin.bottom:this.options.page.margin;return Number(e)}getMarginTop(){return this.getMarginTopMM()*g}getMarginBottom(){return this.getMarginBottomMM()*g}getMarginLeft(){return this.getMarginLeftMM()*g}getMarginRight(){return this.getMarginRightMM()*g}getScale(){return this.options.resolution}getPageHeight(){return this.getPageHeightMM()*g}getPageHeightMM(){return this.pdf.internal.pageSize.height}getPageWidthMM(){return this.pdf.internal.pageSize.width}getPageWidth(){return this.getPageWidthMM()*g}getOriginalCanvasWidth(){return this.canvas.width/this.getScale()}getOriginalCanvasHeight(){return this.canvas.height/this.getScale()}getCanvasPageAvailableHeight(){return this.getPageAvailableHeight()*this.getScale()*this.getHorizontalFitFactor()}getPageAvailableWidth(){return this.getPageWidth()-(this.getMarginLeft()+this.getMarginRight())}getPageAvailableHeight(){return this.getPageHeight()-(this.getMarginTop()+this.getMarginBottom())}getPageAvailableWidthMM(){return this.getPageAvailableWidth()/g}getPageAvailableHeightMM(){return this.getPageAvailableHeight()/g}getNumberPages(){return Math.ceil(this.canvas.height/this.getCanvasPageAvailableHeight())}getHorizontalFitFactor(){return this.getPageAvailableWidth()<this.getOriginalCanvasWidth()?this.getOriginalCanvasWidth()/this.getPageAvailableWidth():1}getCanvasOffsetY(e){return this.getCanvasPageAvailableHeight()*(e-1)}getCanvasHeightLeft(e){return this.canvas.height-this.getCanvasOffsetY(e)}getCanvasPageHeight(e){if(this.canvas.height<this.getCanvasPageAvailableHeight())return this.canvas.height;const a=this.getCanvasHeightLeft(e);return a<this.getCanvasPageAvailableHeight()?a:this.getCanvasPageAvailableHeight()}getCanvasPageWidth(){return this.canvas.width}createCanvasPage(e){const a=this.getCanvasPageWidth(),i=this.getCanvasPageHeight(e),n=document.createElement("canvas");return n.setAttribute("width",String(a)),n.setAttribute("height",String(i)),n.getContext("2d").drawImage(this.canvas,0,this.getCanvasOffsetY(e),this.canvas.width,i,0,0,this.canvas.width,i),n}convert(){let e=1;const a=this.getNumberPages();for(;e<=a;){e>1&&this.pdf.addPage(this.options.page.format,this.options.page.orientation);const i=this.createCanvasPage(e),n=i.toDataURL(this.options.canvas.mimeType,this.options.canvas.qualityRatio);this.pdf.setPage(e),this.pdf.addImage({imageData:n,width:i.width/(this.getScale()*g*this.getHorizontalFitFactor()),height:i.height/(this.getScale()*g*this.getHorizontalFitFactor()),x:this.getMarginLeftMM(),y:this.getMarginTopMM()}),e+=1}return this.pdf}}const u=t=>t?{...r,...t,canvas:{...r.canvas,...t.canvas},page:{...r.page,...t.page}}:r,b=t=>typeof t=="function"?t():t==null?void 0:t.current,C=t=>{const e=p.useRef(),a=p.useCallback(i=>f(e,t??i),[e,t]);return{targetRef:e,toPDF:a}},f=async(t,e)=>{var c;const a=u(e),i=b(t);if(!i){console.error("Unable to get the target element.");return}const n=await d(i,{useCORS:a.canvas.useCORS,logging:a.canvas.logging,scale:a.resolution,...(c=a.overrides)==null?void 0:c.canvas}),s=new M(n,a).convert();switch(a.method){case"build":return s;case"open":return window.open(s.output("bloburl"),"_blank"),s;case"save":default:{const l=a.filename??`${new Date().getTime()}.pdf`;return await s.save(l,{returnPromise:!0}),s}}};export{C as $};
